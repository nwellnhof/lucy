<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<!--
***********************************************

!!!! DO NOT EDIT !!!!

This file was auto-generated by cfc.

***********************************************

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta name="viewport" content="width=device-width" />
<title>Lucy::Index::Indexer – C API Documentation</title>
<style type="text/css">
body {
    max-width: 48em;
    font: 0.85em/1.4 sans-serif;
}
a {
    color: #23b;
}
table {
    border-collapse: collapse;
}
td {
    padding: 0;
}
td.label {
    padding-right: 2em;
    font-weight: bold;
}
dt {
    font-weight: bold;
}
pre {
    border: 1px solid #ccc;
    padding: 0.2em 0.4em;
    background: #f6f6f6;
    font-size: 0.92em;
}
pre a {
    text-decoration: none;
}
pre, code {
    font-family: "Consolas", "Menlo", monospace;
}
span.prefix, span.comment {
    color: #888;
}
</style>
</head>
<body>
<h1>Lucy::Index::Indexer</h1>
<table>
<tr>
<td class="label">parcel</td>
<td><a href="../../lucy.html">Lucy</a></td>
</tr>
<tr>
<td class="label">class variable</td>
<td><code><span class="prefix">LUCY_</span>INDEXER</code></td>
</tr>
<tr>
<td class="label">struct symbol</td>
<td><code><span class="prefix">lucy_</span>Indexer</code></td>
</tr>
<tr>
<td class="label">class nickname</td>
<td><code><span class="prefix">lucy_</span>Indexer</code></td>
</tr>
<tr>
<td class="label">header file</td>
<td><code>Lucy/Index/Indexer.h</code></td>
</tr>
</table>
<h2>Name</h2>
<p>Lucy::Index::Indexer – Build inverted indexes.</p>
<h2>Description</h2>
<p>The Indexer class is Apache Lucy’s primary tool for managing the content of
inverted indexes, which may later be searched using
<a href="../../Lucy/Search/IndexSearcher.html">IndexSearcher</a>.</p>
<p>In general, only one Indexer at a time may write to an index safely.  If a
write lock cannot be secured, new() will throw an exception.</p>
<p>If an index is located on a shared volume, each writer application must
identify itself by supplying an
<a href="../../Lucy/Index/IndexManager.html">IndexManager</a> with a unique
<code>host</code> id to Indexer’s constructor or index corruption will
occur.  See <a href="../../Lucy/Docs/FileLocking.html">FileLocking</a> for a detailed
discussion.</p>
<p>Note: at present, <a href="../../Lucy/Index/Indexer.html#func_Delete_By_Term">Delete_By_Term()</a> and <a href="../../Lucy/Index/Indexer.html#func_Delete_By_Query">Delete_By_Query()</a> only affect
documents which had been previously committed to the index – and not any
documents added this indexing session but not yet committed.  This may
change in a future update.</p>
<h2>Functions</h2>
<dl>
<dt id="func_new">new</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>Indexer* <span class="comment">// incremented</span>
<span class="prefix">lucy_</span><strong>Indexer_new</strong>(
    <span class="prefix">lucy_</span><a href="../../Lucy/Plan/Schema.html">Schema</a> *<strong>schema</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>index</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Index/IndexManager.html">IndexManager</a> *<strong>manager</strong>,
    int32_t <strong>flags</strong>
);
</code></pre>
</dd>
<dt id="func_init">init</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>Indexer*
<span class="prefix">lucy_</span><strong>Indexer_init</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Plan/Schema.html">Schema</a> *<strong>schema</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>index</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Index/IndexManager.html">IndexManager</a> *<strong>manager</strong>,
    int32_t <strong>flags</strong>
);
</code></pre>
<p>Open a new Indexer.  If the index already exists, update it.</p>
<dl>
<dt>schema</dt>
<dd><p>A Schema.</p>
</dd>
<dt>index</dt>
<dd><p>Either a string filepath or a Folder.</p>
</dd>
<dt>manager</dt>
<dd><p>An IndexManager.</p>
</dd>
<dt>flags</dt>
<dd><p>Flags governing behavior.</p>
</dd>
</dl>
</dd>
</dl>
<h2>Methods</h2>
<dl>
<dt id="func_Add_Doc">Add_Doc</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Add_Doc</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Document/Doc.html">Doc</a> *<strong>doc</strong>,
    float <strong>boost</strong>
);
</code></pre>
<p>Add a document to the index.</p>
<dl>
<dt>doc</dt>
<dd><p>A Lucy::Document::Doc object.</p>
</dd>
<dt>boost</dt>
<dd><p>A floating point weight which affects how this document
scores.</p>
</dd>
</dl>
</dd>
<dt id="func_Add_Index">Add_Index</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Add_Index</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>index</strong>
);
</code></pre>
<p>Absorb an existing index into this one.  The two indexes must
have matching Schemas.</p>
<dl>
<dt>index</dt>
<dd><p>Either an index path name or a Folder.</p>
</dd>
</dl>
</dd>
<dt id="func_Delete_By_Term">Delete_By_Term</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Delete_By_Term</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/String.html">String</a> *<strong>field</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>term</strong>
);
</code></pre>
<p>Mark documents which contain the supplied term as deleted, so that
they will be excluded from search results and eventually removed
altogether.  The change is not apparent to search apps until after
<a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> succeeds.</p>
<dl>
<dt>field</dt>
<dd><p>The name of an indexed field. (If it is not spec’d as
<code>indexed</code>, an error will occur.)</p>
</dd>
<dt>term</dt>
<dd><p>The term which identifies docs to be marked as deleted.  If
<code>field</code> is associated with an Analyzer, <code>term</code>
will be processed automatically (so don’t pre-process it yourself).</p>
</dd>
</dl>
</dd>
<dt id="func_Delete_By_Query">Delete_By_Query</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Delete_By_Query</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Search/Query.html">Query</a> *<strong>query</strong>
);
</code></pre>
<p>Mark documents which match the supplied Query as deleted.</p>
<dl>
<dt>query</dt>
<dd><p>A <a href="../../Lucy/Search/Query.html">Query</a>.</p>
</dd>
</dl>
</dd>
<dt id="func_Delete_By_Doc_ID">Delete_By_Doc_ID</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Delete_By_Doc_ID</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>,
    int32_t <strong>doc_id</strong>
);
</code></pre>
<p>Mark the document identified by the supplied document ID as deleted.</p>
<dl>
<dt>doc_id</dt>
<dd><p>A <a href="../../Lucy/Docs/DocIDs.html">document id</a>.</p>
</dd>
</dl>
</dd>
<dt id="func_Optimize">Optimize</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Optimize</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>
);
</code></pre>
<p>Optimize the index for search-time performance.  This may take a
while, as it can involve rewriting large amounts of data.</p>
<p>Every Indexer session which changes index content and ends in a
<a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> creates a new segment.  Once written, segments are never
modified.  However, they are periodically recycled by feeding their
content into the segment currently being written.</p>
<p>The <a href="../../Lucy/Index/Indexer.html#func_Optimize">Optimize()</a> method causes all existing index content to be fed back
into the Indexer.  When <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> completes after an <a href="../../Lucy/Index/Indexer.html#func_Optimize">Optimize()</a>, the
index will consist of one segment.  So <a href="../../Lucy/Index/Indexer.html#func_Optimize">Optimize()</a> must be called
before <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a>.  Also, optimizing a fresh index created from scratch
has no effect.</p>
<p>Historically, there was a significant search-time performance benefit
to collapsing down to a single segment versus even two segments.  Now
the effect of collapsing is much less significant, and calling
<a href="../../Lucy/Index/Indexer.html#func_Optimize">Optimize()</a> is rarely justified.</p>
</dd>
<dt id="func_Commit">Commit</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Commit</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>
);
</code></pre>
<p>Commit any changes made to the index.  Until this is called, none of
the changes made during an indexing session are permanent.</p>
<p>Calling <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> invalidates the Indexer, so if you want to make more
changes you’ll need a new one.</p>
</dd>
<dt id="func_Prepare_Commit">Prepare_Commit</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Prepare_Commit</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>
);
</code></pre>
<p>Perform the expensive setup for <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> in advance, so that <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a>
completes quickly.  (If <a href="../../Lucy/Index/Indexer.html#func_Prepare_Commit">Prepare_Commit()</a> is not called explicitly by
the user, <a href="../../Lucy/Index/Indexer.html#func_Commit">Commit()</a> will call it internally.)</p>
</dd>
<dt id="func_Get_Schema">Get_Schema</dt>
<dd>
<pre><code><span class="prefix">lucy_</span><a href="../../Lucy/Plan/Schema.html">Schema</a>*
<span class="prefix">lucy_</span><strong>Indexer_Get_Schema</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>
);
</code></pre>
<p>Accessor for schema.</p>
</dd>
<dt id="func_Destroy">Destroy</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>Indexer_Destroy</strong>(
    <span class="prefix">lucy_</span>Indexer *<strong>self</strong>
);
</code></pre>
<p>Generic destructor.  Frees the struct itself but not any complex
member elements.</p>
</dd>
</dl>
<h2>Inheritance</h2>
<p>Lucy::Index::Indexer is a <a href="../../Clownfish/Obj.html">Clownfish::Obj</a>.</p>
</body>
</html>
