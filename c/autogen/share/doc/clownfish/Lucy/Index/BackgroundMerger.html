<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<!--
***********************************************

!!!! DO NOT EDIT !!!!

This file was auto-generated by cfc.

***********************************************

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta name="viewport" content="width=device-width" />
<title>Lucy::Index::BackgroundMerger – C API Documentation</title>
<style type="text/css">
body {
    max-width: 48em;
    font: 0.85em/1.4 sans-serif;
}
a {
    color: #23b;
}
table {
    border-collapse: collapse;
}
td {
    padding: 0;
}
td.label {
    padding-right: 2em;
    font-weight: bold;
}
dt {
    font-weight: bold;
}
pre {
    border: 1px solid #ccc;
    padding: 0.2em 0.4em;
    background: #f6f6f6;
    font-size: 0.92em;
}
pre a {
    text-decoration: none;
}
pre, code {
    font-family: "Consolas", "Menlo", monospace;
}
span.prefix, span.comment {
    color: #888;
}
</style>
</head>
<body>
<h1>Lucy::Index::BackgroundMerger</h1>
<table>
<tr>
<td class="label">parcel</td>
<td><a href="../../lucy.html">Lucy</a></td>
</tr>
<tr>
<td class="label">class variable</td>
<td><code><span class="prefix">LUCY_</span>BACKGROUNDMERGER</code></td>
</tr>
<tr>
<td class="label">struct symbol</td>
<td><code><span class="prefix">lucy_</span>BackgroundMerger</code></td>
</tr>
<tr>
<td class="label">class nickname</td>
<td><code><span class="prefix">lucy_</span>BGMerger</code></td>
</tr>
<tr>
<td class="label">header file</td>
<td><code>Lucy/Index/BackgroundMerger.h</code></td>
</tr>
</table>
<h2>Name</h2>
<p>Lucy::Index::BackgroundMerger – Consolidate index segments in the background.</p>
<h2>Description</h2>
<p>Adding documents to an index is usually fast, but every once in a while the
index must be compacted and an update takes substantially longer to
complete.  See <a href="../../Lucy/Docs/Cookbook/FastUpdates.html">FastUpdates</a> for how to use this class to control
worst-case index update performance.</p>
<p>As with <a href="../../Lucy/Index/Indexer.html">Indexer</a>, see <a href="../../Lucy/Docs/FileLocking.html">FileLocking</a> if your index is on a
shared volume.</p>
<h2>Functions</h2>
<dl>
<dt id="func_new">new</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>BackgroundMerger* <span class="comment">// incremented</span>
<span class="prefix">lucy_</span><strong>BGMerger_new</strong>(
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>index</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Index/IndexManager.html">IndexManager</a> *<strong>manager</strong>
);
</code></pre>
</dd>
<dt id="func_init">init</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>BackgroundMerger*
<span class="prefix">lucy_</span><strong>BGMerger_init</strong>(
    <span class="prefix">lucy_</span>BackgroundMerger *<strong>self</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/Obj.html">Obj</a> *<strong>index</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Index/IndexManager.html">IndexManager</a> *<strong>manager</strong>
);
</code></pre>
<p>Open a new BackgroundMerger.</p>
<dl>
<dt>index</dt>
<dd><p>Either a string filepath or a Folder.</p>
</dd>
<dt>manager</dt>
<dd><p>An IndexManager.  If not supplied, an IndexManager with
a 10-second write lock timeout will be created.</p>
</dd>
</dl>
</dd>
</dl>
<h2>Methods</h2>
<dl>
<dt id="func_Optimize">Optimize</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>BGMerger_Optimize</strong>(
    <span class="prefix">lucy_</span>BackgroundMerger *<strong>self</strong>
);
</code></pre>
<p>Optimize the index for search-time performance.  This may take a
while, as it can involve rewriting large amounts of data.</p>
</dd>
<dt id="func_Commit">Commit</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>BGMerger_Commit</strong>(
    <span class="prefix">lucy_</span>BackgroundMerger *<strong>self</strong>
);
</code></pre>
<p>Commit any changes made to the index.  Until this is called, none of
the changes made during an indexing session are permanent.</p>
<p>Calls <a href="../../Lucy/Index/BackgroundMerger.html#func_Prepare_Commit">Prepare_Commit()</a> implicitly if it has not already been called.</p>
</dd>
<dt id="func_Prepare_Commit">Prepare_Commit</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>BGMerger_Prepare_Commit</strong>(
    <span class="prefix">lucy_</span>BackgroundMerger *<strong>self</strong>
);
</code></pre>
<p>Perform the expensive setup for <a href="../../Lucy/Index/BackgroundMerger.html#func_Commit">Commit()</a> in advance, so that <a href="../../Lucy/Index/BackgroundMerger.html#func_Commit">Commit()</a>
completes quickly.</p>
<p>Towards the end of <a href="../../Lucy/Index/BackgroundMerger.html#func_Prepare_Commit">Prepare_Commit()</a>, the BackgroundMerger attempts to
re-acquire the write lock, which is then held until <a href="../../Lucy/Index/BackgroundMerger.html#func_Commit">Commit()</a> finishes
and releases it.</p>
</dd>
<dt id="func_Destroy">Destroy</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>BGMerger_Destroy</strong>(
    <span class="prefix">lucy_</span>BackgroundMerger *<strong>self</strong>
);
</code></pre>
<p>Generic destructor.  Frees the struct itself but not any complex
member elements.</p>
</dd>
</dl>
<h2>Inheritance</h2>
<p>Lucy::Index::BackgroundMerger is a <a href="../../Clownfish/Obj.html">Clownfish::Obj</a>.</p>
</body>
</html>
