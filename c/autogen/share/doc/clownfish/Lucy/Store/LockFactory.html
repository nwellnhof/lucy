<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<!--
***********************************************

!!!! DO NOT EDIT !!!!

This file was auto-generated by cfc.

***********************************************

Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<meta name="viewport" content="width=device-width" />
<title>Lucy::Store::LockFactory – C API Documentation</title>
<style type="text/css">
body {
    max-width: 48em;
    font: 0.85em/1.4 sans-serif;
}
a {
    color: #23b;
}
table {
    border-collapse: collapse;
}
td {
    padding: 0;
}
td.label {
    padding-right: 2em;
    font-weight: bold;
}
dt {
    font-weight: bold;
}
pre {
    border: 1px solid #ccc;
    padding: 0.2em 0.4em;
    background: #f6f6f6;
    font-size: 0.92em;
}
pre a {
    text-decoration: none;
}
pre, code {
    font-family: "Consolas", "Menlo", monospace;
}
span.prefix, span.comment {
    color: #888;
}
</style>
</head>
<body>
<h1>Lucy::Store::LockFactory</h1>
<table>
<tr>
<td class="label">parcel</td>
<td><a href="../../lucy.html">Lucy</a></td>
</tr>
<tr>
<td class="label">class variable</td>
<td><code><span class="prefix">LUCY_</span>LOCKFACTORY</code></td>
</tr>
<tr>
<td class="label">struct symbol</td>
<td><code><span class="prefix">lucy_</span>LockFactory</code></td>
</tr>
<tr>
<td class="label">class nickname</td>
<td><code><span class="prefix">lucy_</span>LockFact</code></td>
</tr>
<tr>
<td class="label">header file</td>
<td><code>Lucy/Store/LockFactory.h</code></td>
</tr>
</table>
<h2>Name</h2>
<p>Lucy::Store::LockFactory – Create Locks.</p>
<h2>Description</h2>
<p>LockFactory is used to spin off interprocess mutex locks used by various
index reading and writing components.  The default implementation uses
lockfiles, but LockFactory subclasses which are implemented using
alternatives such as flock() are possible.</p>
<h2>Functions</h2>
<dl>
<dt id="func_new">new</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>LockFactory* <span class="comment">// incremented</span>
<span class="prefix">lucy_</span><strong>LockFact_new</strong>(
    <span class="prefix">lucy_</span><a href="../../Lucy/Store/Folder.html">Folder</a> *<strong>folder</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/String.html">String</a> *<strong>host</strong>
);
</code></pre>
<p>Create a new LockFactory.</p>
<dl>
<dt>folder</dt>
<dd><p>A <a href="../../Lucy/Store/Folder.html">Folder</a>.</p>
</dd>
<dt>host</dt>
<dd><p>An identifier which should be unique per-machine.</p>
</dd>
</dl>
</dd>
<dt id="func_init">init</dt>
<dd>
<pre><code><span class="prefix">lucy_</span>LockFactory*
<span class="prefix">lucy_</span><strong>LockFact_init</strong>(
    <span class="prefix">lucy_</span>LockFactory *<strong>self</strong>,
    <span class="prefix">lucy_</span><a href="../../Lucy/Store/Folder.html">Folder</a> *<strong>folder</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/String.html">String</a> *<strong>host</strong>
);
</code></pre>
<p>Initialize a LockFactory.</p>
<dl>
<dt>folder</dt>
<dd><p>A <a href="../../Lucy/Store/Folder.html">Folder</a>.</p>
</dd>
<dt>host</dt>
<dd><p>An identifier which should be unique per-machine.</p>
</dd>
</dl>
</dd>
</dl>
<h2>Methods</h2>
<dl>
<dt id="func_Make_Lock">Make_Lock</dt>
<dd>
<pre><code><span class="prefix">lucy_</span><a href="../../Lucy/Store/Lock.html">Lock</a>* <span class="comment">// incremented</span>
<span class="prefix">lucy_</span><strong>LockFact_Make_Lock</strong>(
    <span class="prefix">lucy_</span>LockFactory *<strong>self</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/String.html">String</a> *<strong>name</strong>,
    int32_t <strong>timeout</strong>,
    int32_t <strong>interval</strong>
);
</code></pre>
<p>Return a Lock object, which, once <a href="../../Lucy/Store/Lock.html#func_Obtain">Obtain()</a> returns successfully,
maintains an exclusive lock on a resource.</p>
<dl>
<dt>name</dt>
<dd><p>A file-system-friendly id which identifies the
resource to be locked.</p>
</dd>
<dt>timeout</dt>
<dd><p>Time in milliseconds to keep retrying before abandoning
the attempt to <a href="../../Lucy/Store/Lock.html#func_Obtain">Obtain()</a> a lock.</p>
</dd>
<dt>interval</dt>
<dd><p>Time in milliseconds between retries.</p>
</dd>
</dl>
</dd>
<dt id="func_Make_Shared_Lock">Make_Shared_Lock</dt>
<dd>
<pre><code><span class="prefix">lucy_</span><a href="../../Lucy/Store/Lock.html">Lock</a>* <span class="comment">// incremented</span>
<span class="prefix">lucy_</span><strong>LockFact_Make_Shared_Lock</strong>(
    <span class="prefix">lucy_</span>LockFactory *<strong>self</strong>,
    <span class="prefix">cfish_</span><a href="../../Clownfish/String.html">String</a> *<strong>name</strong>,
    int32_t <strong>timeout</strong>,
    int32_t <strong>interval</strong>
);
</code></pre>
<p>Return a Lock object for which <a href="../../Lucy/Store/Lock.html#func_Shared">Shared()</a> returns true, and which
maintains a non-exclusive lock on a resource once <a href="../../Lucy/Store/Lock.html#func_Obtain">Obtain()</a> returns
success.</p>
<dl>
<dt>name</dt>
<dd><p>A file-system-friendly id which identifies the
resource to be locked.</p>
</dd>
<dt>timeout</dt>
<dd><p>Time in milliseconds to keep retrying before abandoning
the attempt to <a href="../../Lucy/Store/Lock.html#func_Obtain">Obtain()</a> a lock.</p>
</dd>
<dt>interval</dt>
<dd><p>Time in milliseconds between retries.</p>
</dd>
</dl>
</dd>
<dt id="func_Destroy">Destroy</dt>
<dd>
<pre><code>void
<span class="prefix">lucy_</span><strong>LockFact_Destroy</strong>(
    <span class="prefix">lucy_</span>LockFactory *<strong>self</strong>
);
</code></pre>
<p>Generic destructor.  Frees the struct itself but not any complex
member elements.</p>
</dd>
</dl>
<h2>Inheritance</h2>
<p>Lucy::Store::LockFactory is a <a href="../../Clownfish/Obj.html">Clownfish::Obj</a>.</p>
</body>
</html>
